# **Google Research Football 11v11 决策树智能体战术说明文档**

## **1\. 概述与设计哲学**

本文件旨在详细说明一个为 **Google Research Football (GRF)** 环境设计的11人制足球决策树智能体的战术体系与行为逻辑。该智能体将控制左侧（Left Team）全部11名球员，与环境内置AI进行对抗。

我们的核心设计基于以下原则：

* **分层决策 (Hierarchical Decision-Making)**: 智能体的最高决策层级由比赛的实时模式 game\_mode 决定（如常规比赛、角球、任意球等）。这能有效地将复杂的比赛情境分解为多个独立的、更易于管理的战术子问题。  
* **角色化智能 (Role-Based Intelligence)**: 每位球员的决策逻辑都将严格基于其在场上的预设角色（如中后卫、中场、前锋等）。球员角色根据场景加载时的 left\_team\_roles 信息确定。  
* **状态驱动行为 (State-Driven Actions)**: 球员在场上的行为主要由两个核心状态驱动：**我方控球（进攻）** 和 **对方/无人控球（防守/争抢）**。在这些宏观状态下，再结合更精细的场上变量（如球员位置、与球的距离、得分情况等）做出最终的动作选择。  
* **观测空间利用**: 我们将完全基于 representation='raw' 的观测空间。该表示法提供了最丰富、最结构化的原始数据（如球员坐标、速度、比赛状态等），是构建精细化决策规则的坚实基础。

## **2\. 阵型与核心战术 (常规比赛模式)**

### **2.1 阵型分析**

根据 scenario\_config.md 文件提供的初始球员角色配置，我方（左队）采用的阵型为 **4-5-1**。

* **后卫线 (4人)**: 左后卫 (Index 3), 右后卫 (Index 6), 2名中后卫 (Indices 4, 5)。  
* **中场线 (5人)**: 右中场 (Index 1), 左中场 (Index 10), 3名中中场 (Indices 7, 8, 9)。  
* **前锋线 (1人)**: 中锋 (Index 2)。

### **2.2 总体战术部署**

基于4-5-1阵型的特点以及《足球战术常见分析及应用》的理论，我们制定了以下核心战术：

* **防守策略：中场逼抢 (Mid-Block)**  
  * **原则**: 不采用激进的高位逼抢，也不完全退守本方禁区。利用5名中场的人数优势，在中场核心区域构建一个紧凑的防守阵型，压缩对手的活动空间。  
  * **目标**: 封锁对方的渗透传球线路，迫使其向边路转移，并在中场区域寻机断球并发动反击。  
* **进攻策略：控球与快速反击结合**  
  * **控球基础**: 利用中场人数优势，通过耐心的短传配合来控制比赛节奏，寻找进攻机会。  
  * **快速反击**: 一旦在中场成功断球，立刻利用对方阵型前压留下的空当，以最快速度、最简洁的配合将球推进至前场，形成射门机会。  
* **攻防转换 (Transitions)**  
  * **由守转攻 (进攻转换)**: 在我方半场断球后，优先通过快速、向前的传递寻找前锋或边路球员，发动反击。  
  * **由攻转守 (防守转换)**: 在对方半场丢失球权后，不进行高风险的就地反抢，而是要求全体球员（尤其是中前场球员）迅速回撤至中场区域，快速重建我们的 **Mid-Block** 防守阵型。

## **3\. 常规比赛模式 (e\_GameMode\_Normal) 决策逻辑**

### **3.1 核心派生特征**

为了简化决策树的判断条件并提升其鲁棒性，我们将基于 raw 观测数据构建一系列派生特征，而非直接使用原始坐标。

* distance\_to(obj): 计算与某个对象（球、其他球员、球门）的距离。  
* closest\_teammate / closest\_opponent: 找到最近的队友/对手。  
* is\_in\_opponent\_half(): 判断球员或球是否在对方半场。  
* can\_shoot(): 判断是否处于一个合理的射门位置（例如，在对方半场、距离球门一定范围内且朝向球门）。

### **3.2 顶层决策逻辑**

所有球员的决策都将遵循以下基于控球权的基础逻辑分支：

```
// 伪代码: 球员决策入口  
function decide\_action(my\_index, obs):  
  ball\_owner \= obs\['ball\_owned\_team'\]

  if ball\_owner \== 0: // 我方控球  
    return Offensive\_Logic(my\_index, obs)  
  elif ball\_owner \== 1: // 对方控球  
    return Defensive\_Logic(my\_index, obs)  
  else: // 无人控球 (ball\_owner \== \-1)  
    return Contention\_Logic(my\_index, obs)
```

### **3.3 分角色决策详述**

#### **守门员 (Goalkeeper \- Index 0\)**

* **进攻 (控球时)**:  
  * 寻找最近且未被紧逼的后卫进行短传 (action\_short\_pass)。  
  * 若后卫被压迫，则向中场进行长传 (action\_long\_pass) 以缓解压力。  
* **防守 (无球时)**:  
  * 始终保持在球和球门中心的连线上，根据球的位置微调站位。  
  * 当球进入禁区且无人控制时，果断出击拿球。

#### **后卫线 (Defenders \- Indices 3, 4, 5, 6\)**

* **进攻 (我方控球)**:  
  * **中后卫 (4, 5\)**: 主要任务是安全出球，优先短传给中场球员。不轻易长距离盘带。  
  * **边后卫 (3, 6\)**: 在确保侧翼安全的前提下，可以前压至中线附近接应，或在特定战术时机下（如边路中场内切后）套边插上。  
* **防守 (对方控球)**:  
  * **核心原则**: 保持防线的完整性和紧凑性，不轻易失位。  
  * **离球最近的后卫**: 负责上抢压迫对方持球队员，可使用冲刺 (action\_sprint) 接近，在合适时机进行铲球 (action\_sliding)。  
  * **其他后卫**: 保持位置，盯防对方前锋，准备协防和拦截传球。

#### **中场 (Midfielders \- Indices 1, 7, 8, 9, 10\)**

* **进攻 (我方控球)**:  
  * **控球时**: 作为球队的决策核心。根据场上局势，在向前直塞 (action\_high\_pass)、横传保持控球 (action\_short\_pass)、盘带突破 (action\_dribble) 和远射 (action\_shot) 之间做出选择。  
  * **无球时**: 积极进行无球跑动，为队友创造传球线路，形成传球三角。  
* **防守 (对方控球)**:  
  * **核心任务**: 快速回防，组成紧凑的 **Mid-Block** 阵型。  
  * **离球最近的中场**: 负责上抢延缓对方推进。  
  * **其他中场**: 封锁对方中路的传球路线，保护后卫线身前的关键区域。

#### **前锋 (Forward \- Index 2\)**

* **进攻 (我方控球)**:  
  * **无球时**: 积极冲击对方防线身后，通过跑位撕扯对方防守阵型，为中场队友创造空间。  
  * **控球时**: 若有机会，坚决射门 (action\_shot)。若背对球门，可选择回传做球 (action\_short\_pass) 给后插上的中场队友。  
* **防守 (对方控球)**:  
  * 作为第一道防线，对对方持球的中后卫进行骚扰性逼抢，干扰其轻松出球，但不进行鲁莽的、消耗体能的深度压迫。

## **4\. 定位球及其他模式 (Set Pieces & Other Modes)**

当 obs\['game\_mode'\] 不为 e\_GameMode\_Normal 时，智能体将切换到专门的定位球逻辑。

### **4.1 顶层决策分支**

```
// 伪代码: 定位球总控  
function get\_action(my\_index, obs):  
  switch(obs\['game\_mode'\]):  
    case 1 (KickOff): return KickOff\_Logic(...)  
    case 2 (GoalKick): return GoalKick\_Logic(...)  
    case 3 (FreeKick): return FreeKick\_Logic(...)  
    case 4 (Corner): return Corner\_Logic(...)  
    case 5 (ThrowIn): return ThrowIn\_Logic(...)  
    case 6 (Penalty): return Penalty\_Logic(...)
```

### **4.2 各模式战术简述**

* **开球 (KickOff)**:  
  * **进攻**: 控球者短传给最近的队友，快速将球转移到安全区域，开始组织进攻。  
* **球门球 (GoalKick)**:  
  * **进攻**: 守门员根据对方前锋的逼抢强度，选择短传给后卫或长传开向中场。  
* **任意球 (FreeKick)**:  
  * **进攻**: 近距离直接射门 (action\_shot)；远距离或角度不佳时，高球吊入禁区 (action\_high\_pass)。  
  * **防守**: 自动形成人墙，其余球员盯防对方关键球员或保护关键区域。  
* **角球 (Corner)**:  
  * **进攻**: 主罚者高球传入禁区，安排高大球员（如中后卫）抢点，部分球员在禁区外保护第二落点。  
  * **防守**: 采用混合防守。安排球员在前后门柱保护，其余球员对对方关键争顶球员进行盯防。  
* **点球 (Penalty)**:  
  * **进攻**: 主罚者执行射门 (action\_shot)。  
  * **防守**: 守门员随机选择一个方向进行扑救 (action\_left 或 action\_right)。

## **5\. 实施考量**

### **5.1 粘性动作管理 (Managing Sticky Actions)**

“粘性动作”（如8个方向的移动、冲刺、盘带）是GRF环境的一个核心机制。

* **输入**: 决策树的输入必须包含 obs\['sticky\_actions'\] 向量。这能让决策树知道当前哪些动作是持续生效的。  
* **维持**: 若想维持当前的移动或冲刺状态，决策树可以输出 action\_idle (0)。  
* **停止/改变**: 必须显式地输出“释放”动作（如 action\_release\_direction）来停止移动，或输出一个新的方向/动作来覆盖当前动作。

### **5.2 迭代开发与调试**

* **从简到繁**: 从实现最基础的“追球-射门”逻辑开始，逐步增加角色分工、传球配合和战术跑位。  
* **可视化调试**: 在开发阶段必须将 render 参数设为 True。通过直观地观察智能体的行为，可以快速定位逻辑缺陷。  
* **日志分析**: 记录关键时间步的观测数据、AI决策及原因，用于后续分析和优化。

### **5.3 动作合法性**

决策树的规则设计需要隐式地包含对动作合法性的判断。

* 例如，盘带 (action\_dribble) 相关的决策分支，其前提条件应为 obs\['ball\_owned\_team'\] \== 0 且 obs\['ball\_owned\_player'\] \== my\_index。  
* 同样，铲球 (action\_sliding) 的决策应在 obs\['ball\_owned\_team'\] \!= 0 的条件下触发。